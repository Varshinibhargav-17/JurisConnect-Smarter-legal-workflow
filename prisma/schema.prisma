// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/////////////////////////////////////////////////////
// USERS
/////////////////////////////////////////////////////

model User {
  id                    Int     @id @default(autoincrement())
  name                  String
  email                 String  @unique
  phone                 String?
  bar_enrollment_number String?
  hourly_rate           Float?

  // Relations
  clients Client[]
  matters Matter[]

  created_at DateTime @default(now())
}

/////////////////////////////////////////////////////
// CLIENTS
/////////////////////////////////////////////////////

model Client {
  id         Int      @id @default(autoincrement())
  user_id    Int
  name       String
  email      String?
  phone      String?
  address    String?
  created_at DateTime @default(now())

  // Relations
  user    User     @relation(fields: [user_id], references: [id])
  matters Matter[]
}

/////////////////////////////////////////////////////
// MATTERS
/////////////////////////////////////////////////////

model Matter {
  id               Int      @id @default(autoincrement())
  user_id          Int
  client_id        Int
  title            String
  case_number      String?
  case_type        String // civil, criminal, corporate
  court_name       String?
  judge_name       String?
  opposing_party   String?
  opposing_counsel String?
  status           String // active, closed, on_hold
  created_at       DateTime @default(now())

  // Relations
  user       User        @relation(fields: [user_id], references: [id])
  client     Client      @relation(fields: [client_id], references: [id])
  courtDates CourtDate[]
  tasks      Task[]
  documents  Document[]
}

/////////////////////////////////////////////////////
// COURT DATES
/////////////////////////////////////////////////////

model CourtDate {
  id            Int      @id @default(autoincrement())
  matter_id     Int
  date          DateTime
  time          String?
  purpose       String?
  court_room    String?
  notes         String?
  reminder_sent Boolean  @default(false)

  // Relation
  matter Matter @relation(fields: [matter_id], references: [id])
}

/////////////////////////////////////////////////////
// TASKS
/////////////////////////////////////////////////////

model Task {
  id          Int       @id @default(autoincrement())
  matter_id   Int
  title       String
  description String?
  due_date    DateTime?
  priority    String // low, medium, high, critical
  status      String // pending, completed
  created_at  DateTime  @default(now())

  // Relation
  matter Matter @relation(fields: [matter_id], references: [id])
}

/////////////////////////////////////////////////////
// DOCUMENTS
/////////////////////////////////////////////////////

model Document {
  id          Int      @id @default(autoincrement())
  matter_id   Int
  file_name   String
  file_url    String
  file_type   String?
  uploaded_at DateTime @default(now())

  // Relation
  matter Matter @relation(fields: [matter_id], references: [id])
}
